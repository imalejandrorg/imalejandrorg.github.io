<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Bioestadística con R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Alejandro Ruiz" />
    <meta name="date" content="2021-10-19" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Bioestadística con R
### Alejandro Ruiz
### 2021-10-19

---

class: inverse, middle, center







# Probabilidad

---
# Probabilidad

--

Una **distribución de probabilidad** corresponde a una descripción que da la probabilidad para cada valor de una variable aleatoria. La variable aleatoria puede ser **discreta** o puede ser **continua.**

--

Un **histogramas de frecuencias relativas** representa las proporciones de las observaciones en cada categoría. 

--

Para variables continuas normalmente se utilizan clases muy estrechas para representar al histograma como una **curva de densidad.** 

--

La coordenada `\(y\)` de una curva de densidad representa la escala de densidad y a menudo las frecuencias relativas se representan como **áreas debajo de la curva.**

---
#  Probabilidad frecuentista

En este enfoque, la probabilidad de un evento se determina a través por el número de veces que el evento `\(A\)` ocurre en una serie de repeticiones indefinidamente largas.

--

$$
P(A) = \frac{Veces \space que \space ocurre \space A}{Número \space total \space de \space repeticiones}
$$

---
class: middle, center, inverse
# Reglas de probabilidad

---
# Reglas de probabilidad

--

1- La probabilidad de que un evento `\(A\)` ocurra está siempre entre 0 y 1. 

$$
0 \le P(A) \le 1
$$

--

2- Siempre y cuando dos eventos sean complementarios, la suma de probabilidades debe ser igual a 1.

$$
P(A) + P(\bar{A}) = 1
$$

--

3- La probabilidad de que el evento `\(A\)` no ocurra es...

$$
P(\bar{A}) = 1 - P(A)
$$

Donde `\(P(\bar{A})\)` es el **complemento** de `\(P(A)\)`.

---
# Reglas de probabilidad

--

4- Si `\(A\)` y `\(B\)` son eventos **disjuntos** (no ocurren en conjunto):

$$
P(A \cup B) = P(A) + P(B)
$$

--

&lt;img src="no_conjuntos.png" width="818" style="display: block; margin: auto;" /&gt;

---
# Reglas de probabilidad

--

5- Si `\(A\)` y `\(B\)` son eventos que ocurren en **conjunto:**

$$
P(A \cup B) = P(A) + P(B) - P(A \cap B)
$$

Donde `\(P(A \cap B)\)` es la probabilidad de que ocurra `\(A\)` y `\(B\)` al mismo tiempo.

--

&lt;img src="cojnuntos.png" width="554" style="display: block; margin: auto;" /&gt;

---
# Reglas de probabilidad

--

6- Si dos eventos son **independientes,** entonces:

$$
P(A \cap B) = P(A) \times P(B)
$$

--

7- Si dos eventos son **dependientes** entonces:

$$
P(A \cap B) = P(A) \times P(B|A)
$$

--

El valor `\(P(B|A)\)` corresponde a la probabilidad condicional, y nos dice cuál es la probabilidad de que el evento `\(B\)` ocurra dado que ha ocurrido ya el evento `\(A\)`. Para calcular la probabilidad condicional utilizamos:

--

$$
P(A|B) = \frac{P(A \cap B)}{P(B)}
$$

--

$$
P(B|A) = \frac{P(A \cap B)}{P(A)}
$$

--

$$
P(A|B) \ne P(B|A)
$$

---
# Reglas de probabilidad

--

8- Para dos eventos cualesquiera:

$$
P(A) = P(B) \times P(A|B) + P(\bar{B}) \times P(A|\bar{B})
$$

---
# Curvas de densidad

Una **distribución de probabilidad** corresponde a una descripción que da la probabilidad para cada valor de una variable aleatoria. La variable aleatoria puede ser **discreta** o puede ser **continua.**

--

Un **histogramas de frecuencias relativas** representa las proporciones de las observaciones en cada categoría. 

--

Para variables continuas normalmente se utilizan clases muy estrechas para representar al histograma como una **curva de densidad.** 

--

La coordenada `\(y\)` de una curva de densidad representa la escala de densidad y a menudo las frecuencias relativas se representan como **áreas debajo de la curva.**

---
# Curvas de densidad

Algunos de los requisitos de una distribución de probabilidad son:

--

- Que exista una variable aleatoria numérica `\(x\)` y que sus valores estén asociados a una probabilidad.

--

- Que `\(\sum P(x) = 1\)`, donde `\(x\)` asume todos los los valores posibles. El área total bajo la curva de densidad debe ser igual a 1.

--

- Que la probabilidad de ver a `\(x_i\)` se encuentre entre 0 y 1. Es decir, `\(0 \le P(x_i) \le 1\)`.

---
# Ejemplos

.pull-left[
- **Distribución normal**

- **Distribución `\(t\)` de Student** 

- **Distribución de `\(F\)`** 

- **Distribución de Chi**
]

.pull-right[
&lt;img src="clase-03-xaringan_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;
]

---
# Parámetros de una distribución de probabilidad

- **Media:** `\(\mu\)`

- **Varianza:** `\(\sigma^2\)`

- **Desviación estándar:** `\(\sigma\)`

- **Tamaño de muestra:** `\(n\)`

---
class: inverse, middle, center
# Distribución binomial

---
# Distribución binomial

--

- Distribución de probabilidad para una **variable discreta.**

--

- Cuenta el número de éxitos `\((k)\)` tras realizar `\(n\)` veces un experimento. 

--

- Cada *intento* debe ser independiente entre sí. La probabilidad de éxito es fija entre cada intento y se denota con la letra `\(p\)`.

&lt;img src="ejemplos.png" width="776" style="display: block; margin: auto;" /&gt;

---
# Variable aleatoria binomial

--

1.  **Resultados binarios:** Solamente existen dos posibilidades para cada intento (éxito o fracaso, cara o cruz, dominante o recesivo, muerto o vivo, niño o niña, etc.).

--

2.  **Intentos independientes:** Cada prueba o intento deben ser independientes del anterior.

--

3.  **El valor de** `\(n\)` es fijo: Se sabe con antelación el número de pruebas `\(n\)`.

--

4.  **Mismo valor** `\(p\)`: En todos los casos, la probabilidad de éxito o fracaso no debe cambiar, es decir `\(p\)` debe permanecer constante.

--

5.  **Resultados mutuamente excluyentes:** Es decir, no se puede tener éxito y fracaso al mismo tiempo.

--

6.  **Resultados colectivamente exhaustivos:** Al menos uno de los dos resultados debe de ocurrir.

---
# Función de masa de probabilidad (PMF)

La **función de masa de probabilidad (PMF)** o fórmula de la distribución binomial.

$$
P(X = k) = {\binom{n}{k}}{p^{k}}{q^{n-k}}
$$

--

Donde:

-   `\(P(X = k)\)` = probabilidad de obtener `\(k\)` éxitos.

-   `\(\binom{n}{k}\)` = coeficiente binomial.

-   `\(k\)` = número de éxitos.

-   `\(p\)` = probabilidad de éxito.

-   `\(q\)` = probabilidad de fracaso.

-   `\(n\)` = número de pruebas.

---
# Coeficiente binomial

Corresponde al número de formas en las que se puede acomodar un conjunto dado.

$$
{\binom{n}{k}} = \frac{n!}{k!(n-k)!}
$$

---
# Media y desviación estándar de la distribución binomial

En este caso la media es el número promedio de éxitos `\((k)\)` y la desviación estándar es qué tan lejos de esta media caen el resto de los valores de la distribución.

--

$$
\mu = {n}{p}
$$

$$
\sigma = \sqrt{{n}{p}{(1-p)}} = \sqrt{{n}{p}{q}}
$$

--

También podemos calcular la varianza...

--

$$
\sigma^2 = {n}{p}{(1-p)} = {n}{p}{q}
$$

---
# Ejemplo

&gt; Supongamos que analizamos a 5 individuos de una población en la que el 37% de las personas presentan un alelo mutante. Las probabilidades de las distintas configuraciones están dadas por la distribución binomial, en donde `\(n\)` = 5 y `\(p\)` = 0.37. ¿Cuál es la probabilidad de que exactamente 2 personas sean mutantes?

Para esto utilizamos las funciones de `R`...

--

- `dbinom()` nos da un valor exacto de la distribución binomial en el punto indicado.

--

- `pbinom()` nos da la probabilidad acumulada de un evento.

--

- `qbinom()` toma el valor de probabilidad que le ponemos como primer argumento y nos da como regreso un número cuya probabilidad acumulada empate con el valor de la probabilidad (también conocida como función cuantil).

--

- `rbinom()` genera cierta cantidad de número aleatorios de acuerdo con la probabilidad y el número de pruebas realizadas.


---
# Probabilidad de que exactamente 2 personas sean mutantes

¿Qué función podríamos utilizar...?

¡¡`dbinom()`!!

--

En este caso `\(n = 5\)`, `\(p = 0.37\)` y `\(k = 2\)`.


```r
dbinom(2, 5, 0.37)
```

```
## [1] 0.3423143
```

---
# Probabilidad de que exactamente 2 personas sean mutantes

&lt;img src="clase-03-xaringan_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---
# Otro ejemplo...

En Estados Unidos, 85% de la población tiene sangre Rh positivo. Supongamos que tomamos 6 personas y contamos cuántos tiene Rh positivo. En este caso `\(Y\)` representará cuántas personas tienen Rh positivo dentro del grupo de 6.

--

1. ¿Cuál es la probabilidad de `\(Y\)` = 4?

--

2. ¿Y la probabilidad de que *al menos* 4 personas sean Rh positivo?

--

3. ¿Y la probabilidad de que haya *al menos* 1 persona con Rh negativo?

---
# Otro ejemplo...

Para el punto 1 buscamos una probabilidad **exacta**, `\(P(Y = 4)\)`. Es decir podemos utilizar `dbinom()`.


```r
#Probabilidad de que 4 personas tengan Rh positivo.
dbinom(4, 6, 0.85)
```

```
## [1] 0.1761771
```

--

&lt;img src="clase-03-xaringan_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;

---
# Otro ejemplo...

Para el punto 2, buscamos que *al menos* 4 personas tengan Rh +, es decir `\(P(Y \ge 4) = P(Y = 4) + P(Y=5) + P(Y=6)\)`.


```r
#Probabilidad de que al menos 4 personas (pueden ser 4, 5 o 6) tengan Rh positivo.
pbinom(3, 6, 0.85, lower.tail = FALSE)
```

```
## [1] 0.9526614
```

--

&lt;img src="clase-03-xaringan_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;

---
# Otro ejemplo...

Para el punto 3, buscamos que *al menos* una persona tenga Rh -. Por ende buscamos el complemento de nuestro evento, `\(P(Y = 0) + P(Y = 1) + P(Y = 2) \cdots + P(Y = 5)\)`, o lo que es lo mismo `\(1 - P(Y = 6)\)`. 


```r
#Probabilidad de que al menos 1 persona tenga Rh negativo.
dbinom(0, 6, 0.85) + dbinom(1, 6, 0.85) + dbinom(2, 6, 0.85) + dbinom(3, 6, 0.85) + dbinom(4, 6, 0.85) + dbinom(5, 6, 0.85)
```

```
## [1] 0.6228505
```

```r
1 - dbinom(6, 6, 0.85)
```

```
## [1] 0.6228505
```

```r
pbinom(5, 6, 0.85)
```

```
## [1] 0.6228505
```

---
# Otro ejemplo...

&lt;img src="clase-03-xaringan_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
