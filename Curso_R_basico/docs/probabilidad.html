<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lección 4 Probabilidad | Curso de R básico</title>
  <meta name="description" content="Curso de R cubriendo los aspectos básicos para el análisis de datos biológicos." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Lección 4 Probabilidad | Curso de R básico" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de R cubriendo los aspectos básicos para el análisis de datos biológicos." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lección 4 Probabilidad | Curso de R básico" />
  
  <meta name="twitter:description" content="Curso de R cubriendo los aspectos básicos para el análisis de datos biológicos." />
  

<meta name="author" content="Alejandro Ruiz-García" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estadística-descriptiva.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso de R básico</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Requisitos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#descarga-de-r-y-rstudio"><i class="fa fa-check"></i><b>1.1</b> Descarga de R y RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción-a-r.html"><a href="introducción-a-r.html"><i class="fa fa-check"></i><b>2</b> Introducción a R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducción-a-r.html"><a href="introducción-a-r.html#interfaz"><i class="fa fa-check"></i><b>2.1</b> Interfaz</a></li>
<li class="chapter" data-level="2.2" data-path="introducción-a-r.html"><a href="introducción-a-r.html#creando-nuestro-primer-proyecto"><i class="fa fa-check"></i><b>2.2</b> Creando nuestro primer proyecto</a></li>
<li class="chapter" data-level="2.3" data-path="introducción-a-r.html"><a href="introducción-a-r.html#objetos-y-variables"><i class="fa fa-check"></i><b>2.3</b> Objetos y variables</a></li>
<li class="chapter" data-level="2.4" data-path="introducción-a-r.html"><a href="introducción-a-r.html#instalar-paquetes"><i class="fa fa-check"></i><b>2.4</b> Instalar paquetes</a></li>
<li class="chapter" data-level="2.5" data-path="introducción-a-r.html"><a href="introducción-a-r.html#importar-datos-a-r"><i class="fa fa-check"></i><b>2.5</b> Importar datos a R</a></li>
<li class="chapter" data-level="2.6" data-path="introducción-a-r.html"><a href="introducción-a-r.html#comentarios"><i class="fa fa-check"></i><b>2.6</b> Comentarios</a></li>
<li class="chapter" data-level="2.7" data-path="introducción-a-r.html"><a href="introducción-a-r.html#exportar-datos"><i class="fa fa-check"></i><b>2.7</b> Exportar datos</a></li>
<li class="chapter" data-level="2.8" data-path="introducción-a-r.html"><a href="introducción-a-r.html#pedir-ayuda"><i class="fa fa-check"></i><b>2.8</b> Pedir ayuda</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html"><i class="fa fa-check"></i><b>3</b> Estadística descriptiva</a>
<ul>
<li class="chapter" data-level="3.1" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#medidas-de-tendencia-central"><i class="fa fa-check"></i><b>3.1</b> Medidas de tendencia central</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#media"><i class="fa fa-check"></i><b>3.1.1</b> Media</a></li>
<li class="chapter" data-level="3.1.2" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#mediana"><i class="fa fa-check"></i><b>3.1.2</b> Mediana</a></li>
<li class="chapter" data-level="3.1.3" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#moda"><i class="fa fa-check"></i><b>3.1.3</b> Moda</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#medidas-de-dispersión"><i class="fa fa-check"></i><b>3.2</b> Medidas de dispersión</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#rango"><i class="fa fa-check"></i><b>3.2.1</b> Rango</a></li>
<li class="chapter" data-level="3.2.2" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#desviación-estándar"><i class="fa fa-check"></i><b>3.2.2</b> Desviación estándar</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#medidas-de-posición-relativa"><i class="fa fa-check"></i><b>3.3</b> Medidas de posición relativa</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#valores-z"><i class="fa fa-check"></i><b>3.3.1</b> Valores Z</a></li>
<li class="chapter" data-level="3.3.2" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#frecuencia-absoluta"><i class="fa fa-check"></i><b>3.3.2</b> Frecuencia absoluta</a></li>
<li class="chapter" data-level="3.3.3" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#frecuencia-relativa"><i class="fa fa-check"></i><b>3.3.3</b> Frecuencia relativa</a></li>
<li class="chapter" data-level="3.3.4" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#cuartiles"><i class="fa fa-check"></i><b>3.3.4</b> Cuartiles</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="estadística-descriptiva.html"><a href="estadística-descriptiva.html#el-uso-de-la-librería-dplyr"><i class="fa fa-check"></i><b>3.4</b> El uso de la librería <code>dplyr</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probabilidad.html"><a href="probabilidad.html"><i class="fa fa-check"></i><b>4</b> Probabilidad</a>
<ul>
<li class="chapter" data-level="4.1" data-path="probabilidad.html"><a href="probabilidad.html#probabilidad-frecuentista"><i class="fa fa-check"></i><b>4.1</b> Probabilidad frecuentista</a></li>
<li class="chapter" data-level="4.2" data-path="probabilidad.html"><a href="probabilidad.html#reglas-de-probabilidad"><i class="fa fa-check"></i><b>4.2</b> Reglas de probabilidad</a></li>
<li class="chapter" data-level="4.3" data-path="probabilidad.html"><a href="probabilidad.html#curvas-de-densidad"><i class="fa fa-check"></i><b>4.3</b> Curvas de densidad</a></li>
<li class="chapter" data-level="4.4" data-path="probabilidad.html"><a href="probabilidad.html#distribución-binomial"><i class="fa fa-check"></i><b>4.4</b> Distribución binomial</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="probabilidad.html"><a href="probabilidad.html#media-y-desviación-estándar-de-la-distribución-binomial"><i class="fa fa-check"></i><b>4.4.1</b> Media y desviación estándar de la distribución binomial</a></li>
<li class="chapter" data-level="4.4.2" data-path="probabilidad.html"><a href="probabilidad.html#distribución-binomial-en-r"><i class="fa fa-check"></i><b>4.4.2</b> Distribución binomial en R</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="probabilidad.html"><a href="probabilidad.html#distribución-normal"><i class="fa fa-check"></i><b>4.5</b> Distribución normal</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="probabilidad.html"><a href="probabilidad.html#distribución-normal-en-r"><i class="fa fa-check"></i><b>4.5.1</b> Distribución normal en R</a></li>
<li class="chapter" data-level="4.5.2" data-path="probabilidad.html"><a href="probabilidad.html#pruebas-de-normalidad-en-r"><i class="fa fa-check"></i><b>4.5.2</b> Pruebas de normalidad en R</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="probabilidad.html"><a href="probabilidad.html#distribución-muestral"><i class="fa fa-check"></i><b>4.6</b> Distribución muestral</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="probabilidad.html"><a href="probabilidad.html#poblaciones-muestras-y-distribuciones-muestrales"><i class="fa fa-check"></i><b>4.6.1</b> Poblaciones, muestras y distribuciones muestrales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="5" data-path="análisis-de-varianza-anova.html"><a href="análisis-de-varianza-anova.html"><i class="fa fa-check"></i><b>5</b> Análisis de Varianza (ANOVA)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="análisis-de-varianza-anova.html"><a href="análisis-de-varianza-anova.html#prueba-de-normalidad"><i class="fa fa-check"></i><b>5.1</b> Prueba de normalidad</a></li>
<li class="chapter" data-level="5.2" data-path="análisis-de-varianza-anova.html"><a href="análisis-de-varianza-anova.html#prueba-de-homocedasticidad"><i class="fa fa-check"></i><b>5.2</b> Prueba de homocedasticidad</a></li>
<li class="chapter" data-level="5.3" data-path="análisis-de-varianza-anova.html"><a href="análisis-de-varianza-anova.html#análisis-de-varianza-anova-de-una-vía"><i class="fa fa-check"></i><b>5.3</b> Análisis de varianza (ANOVA de una vía)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="análisis-de-varianza-anova.html"><a href="análisis-de-varianza-anova.html#anova-en-r"><i class="fa fa-check"></i><b>5.3.1</b> ANOVA en R</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="análisis-de-varianza-anova.html"><a href="análisis-de-varianza-anova.html#pruebas-post-hoc"><i class="fa fa-check"></i><b>5.4</b> Pruebas <em>post hoc</em></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curso de R básico</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probabilidad" class="section level1" number="4">
<h1><span class="header-section-number">Lección 4</span> Probabilidad</h1>
<p>La <strong>probabilidad</strong> es una cantidad numérica que expresa qué tan factible es que ocurra un evento.
Normalmente es expresada como P(A), donde A expresa un evento aleatorio.
Siempre se encuentra entre un rango de 0 y 1, o expresado en porcentaje, entre 0% y 100%.
Existen distintas interpretaciones de la probabilidad como la <strong>frecuentista</strong> o la <strong>bayesiana.</strong> En este caso, aprenderemos el enfoque frecuentista como una forma de asignar una probabilidad mensurable a un evento, es decir, la ocurrencia de el evento a la larga.</p>
<div id="probabilidad-frecuentista" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Probabilidad frecuentista</h2>
<p>En este enfoque, la probabilidad de un evento se determina a través por el número de veces que el evento A ocurre en una serie de repeticiones indefinidamente largas.</p>
<p><span class="math display" id="eq:prob">\[\begin{equation}
P(A) = \frac{num_{A}}{num_{T}}
\tag{4.1}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tt num_{A}\)</span> es el número de veces que se repite el evento A y <span class="math inline">\(\tt num_{T}\)</span> es el número total de repeticiones.</p>
</div>
<div id="reglas-de-probabilidad" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Reglas de probabilidad</h2>
<p>Estas son algunas reglas que nos pueden servir para determinar la probabilidad de algunos eventos.</p>
<ol style="list-style-type: decimal">
<li><p>La probabilidad de un evento A siempre se encuentra entre 0 y 1.</p></li>
<li><p>La suma de probabilidades de los eventos tiene que ser igual a 1.</p></li>
<li><p>La probabilidad de que el evento A no ocurra es <span class="math inline">\(\tt 1 - P(A)\)</span> y se denota con el símbolo <span class="math inline">\(\tt A_1^C\)</span>, indicando que es el complemento de <span class="math inline">\(\tt A_1\)</span>.</p></li>
<li><p>Si dos eventos <span class="math inline">\(\tt A_1\)</span> y <span class="math inline">\(\tt A_2\)</span> son eventos que no ocurren en conjunto, entonces <span class="math inline">\(\tt P(A_1 \cup A_2) = P(A_1) + P(A_2)\)</span>.</p></li>
<li><p>Para dos eventos que ocurren en conjunto, <span class="math inline">\(\tt P(A_1 \cup A_2) = P(A_1) + P(A_2) - P(A_1 \cap A_2)\)</span>.</p></li>
</ol>
<table>
<colgroup>
<col width="22%" />
<col width="18%" />
<col width="20%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Cabello Café</th>
<th>Cabello Negro</th>
<th>Cabello Rojo</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Ojos Cafés</strong></td>
<td>400</td>
<td>300</td>
<td>20</td>
<td>720</td>
</tr>
<tr class="even">
<td><strong>Ojos Azules</strong></td>
<td>800</td>
<td>200</td>
<td>50</td>
<td>1050</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td>1200</td>
<td>500</td>
<td>70</td>
<td>1770</td>
</tr>
</tbody>
</table>
<p>En este caso, la probabilidad de que alguien tenga el cabello café (CC) o rojo (CR), <span class="math inline">\(\tt P(CC \cup CR) = P(CC) + P(CR) = 500/1770 + 70 / 1770\)</span>.</p>
<p>La probabilidad de que alguien tenga el cabello café <span class="math inline">\(\tt P(CC) = 1200/1770\)</span>.</p>
<p>La probabilidad de tener ojos azules <span class="math inline">\(\tt P(OA) = 1050/1770\)</span>.</p>
<p>La probabilidad de tener cabello negro y ojos azules <span class="math inline">\(\tt P(CN \cap OA)\)</span> pueden ocurrir en conjunto ya que hay 200 personas con ojos azules y cabello negro.
Entonces <span class="math inline">\(\tt P(CN \cup OA) = P(CN) + P(OA) - P(CN \cap OA) = 500/1770 + 1050/1770 - 200/1770 = 1350/1770\)</span>.</p>
<p>La fórmula de <strong>probabilidad condicional</strong> es la siguiente:</p>
<p><span class="math display" id="eq:prob">\[\begin{equation}
P(A_1 | A_2) = \frac{P(A_1 \cap A_2)}{P(A_2)}
\tag{4.1}
\end{equation}\]</span></p>
<ol start="6" style="list-style-type: decimal">
<li><p>Si dos eventos, <span class="math inline">\(\tt A_1\)</span> y <span class="math inline">\(\tt A_2\)</span> son <strong>independientes,</strong> entonces <span class="math inline">\(\tt P(A_1 \cap A_2) = P(A_1)*P(A_2)\)</span>.</p></li>
<li><p>Para cualquier evento <span class="math inline">\(\tt A_1\)</span> y <span class="math inline">\(\tt A_2\)</span>, <span class="math inline">\(\tt P(A_1 \cap A_2) = P(A_1) * P(A_2 | A_1)\)</span>.</p></li>
</ol>
<p>Por ejemplo, de la tabla anterior, ¿Cuál es la probabilidad de que una persona tenga cabello rojo y ojos cafés?
En este caso, <span class="math inline">\(\tt P(CR \cap OA) = P(CR) * P(OA | CR) = 70/1770*20/70 = 20/1770\)</span>.</p>
<ol start="8" style="list-style-type: decimal">
<li>Para dos eventos cualesquiera, <span class="math inline">\(\tt A_1\)</span> y <span class="math inline">\(\tt A_2\)</span>, <span class="math inline">\(\tt P(A_1) = P(A_2) * P(A_1 | A_2) + P(A_2^C) * P(A_1 | A_2^C )\)</span> donde <span class="math inline">\(\tt A_2^C\)</span> es el complemento de <span class="math inline">\(\tt A_2\)</span>, es decir <span class="math inline">\(\tt 1 - A_2\)</span>.</li>
</ol>
</div>
<div id="curvas-de-densidad" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Curvas de densidad</h2>
<p>Se utilizan para variables continuas.
Los <strong>histogramas de frecuencias relativas</strong> representan las proporciones de las observaciones en cada categoría, en lugar del total de observaciones.
Para variables continuas normalmente se utilizan clases muy estrechas para representar al histograma como una <strong>curva de densidad.</strong> La coordenada y de una curva de densidad representa la escala de densidad y a menudo las frecuencias relativas se representan como áreas debajo de la curva.
El área total bajo la curva debe ser igual a 1.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-72"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-72-1.png" alt="Curva de densidad." width="672" />
<p class="caption">
Figura 4.1: Curva de densidad.
</p>
</div>
<p>Una probabilidad para una variable continua equivale al área debajo de la curva de densidad entre dos puntos.</p>
</div>
<div id="distribución-binomial" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Distribución binomial</h2>
<p>La <strong>distribución binomial</strong> de una variable aleatoria es una distribución de probabilidad discreta, que cuenta el número de éxitos tras realizar <span class="math inline">\(\tt n\)</span> veces un experimento, cada <em>intento</em> debe ser independiente entre sí.
La probabilidad de éxito es fija entre cada intento y se denota con la letra <span class="math inline">\(\tt p\)</span>.
Lo primero que se nos viene a la mente con este tipo de distribuciones son <em>lanzamientos de moneda</em>, sin embargo, el comportamiento de muchos genes también sigue una distribución binomial.</p>
<p>Normalmente, para que una variable aleatoria sea una <strong>variable aleatoria binomial</strong> se requieren los siguientes requisitos:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Resultados binarios:</strong> Solamente existen dos posibilidades para cada intento (éxito o fracaso, cara o cruz, dominante o recesivo, muerto o vivo, niño o niña, etc.).</p></li>
<li><p><strong>Intentos independientes:</strong> Cada prueba o intento deben ser independientes del anterior.</p></li>
<li><p><strong>El valor de</strong> <span class="math inline">\(\tt n\)</span> es fijo: Se sabe con antelación el número de pruebas <span class="math inline">\(\tt n\)</span>.</p></li>
<li><p><strong>Mismo valor</strong> <span class="math inline">\(\tt p\)</span>: En todos los casos, la probabilidad de éxito o fracaso no debe cambiar, es decir <span class="math inline">\(\tt p\)</span> debe permanecer constante.</p></li>
<li><p><strong>Resultados mutuamente excluyentes:</strong> Es decir, no se puede tener éxito y fracaso al mismo tiempo.</p></li>
<li><p><strong>Resultados colectivamente exhaustivos:</strong> Al menos uno de los dos resultados debe de ocurrir.</p></li>
</ol>
<p>Ahora bien, la fórmula de la distribución binomial se indica en la ecuación <a href="probabilidad.html#eq:binom">(4.2)</a>.</p>
<p><span class="math display" id="eq:binom">\[\begin{equation}
P(X = k) = {\binom{n}{k}}{p^{k}}{q^{n-k}}
\tag{4.2}
\end{equation}\]</span></p>
<p>Donde:</p>
<ul>
<li><p><span class="math inline">\(\tt P(X = k)\)</span> = probabilidad de obtener <span class="math inline">\(\tt k\)</span> éxitos.</p></li>
<li><p><span class="math inline">\(\tt \binom{n}{k}\)</span> = coeficiente binomial, que se calcula con la fórmula <a href="probabilidad.html#eq:binc">(4.3)</a>.</p></li>
<li><p><span class="math inline">\(\tt k\)</span> = número de éxitos.</p></li>
<li><p><span class="math inline">\(\tt p\)</span> = probabilidad de éxito.</p></li>
<li><p><span class="math inline">\(\tt q\)</span> = probabilidad de fracaso.</p></li>
<li><p><span class="math inline">\(\tt n\)</span> = número de pruebas.</p></li>
</ul>
<p><span class="math display" id="eq:binc">\[\begin{equation}
_{n}C_{k} = \binom{n}{k} = \frac{n!}{k!(n-k)!}
\tag{4.3}
\end{equation}\]</span></p>
<div id="media-y-desviación-estándar-de-la-distribución-binomial" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Media y desviación estándar de la distribución binomial</h3>
<p>Se pueden calcular tanto la <strong>media</strong> como la <strong>desviación estándar</strong> de una distribución binomial.
La media es el número promedio de éxitos, y la desviación estándar es qué tanto se desvían de la media los valores.</p>
<p>La media de una distribución binomial se calcula con la ecuación <a href="probabilidad.html#eq:meanbinom">(4.4)</a>.</p>
<p><span class="math display" id="eq:meanbinom">\[\begin{equation}
\mu = {n}{p}
\tag{4.4}
\end{equation}\]</span></p>
<p>En cuanto a la desviación estándar se calcula con la siguiente ecuación <a href="probabilidad.html#eq:sdbinom">(4.5)</a>.</p>
<p><span class="math display" id="eq:sdbinom">\[\begin{equation}
\sigma = \sqrt{{n}{p}{(1-p)}} = \sqrt{{n}{p}{q}}
\tag{4.5}
\end{equation}\]</span></p>
<p>En caso de querer obtener la <strong>varianza</strong>, simplemente tomamos la ecuación <a href="probabilidad.html#eq:sdbinom">(4.5)</a> sin aplicar la raíz cuadrada.</p>
<p><span class="math display" id="eq:varbinom">\[\begin{equation}
\sigma^2 = {n}{p}{(1-p)} = {n}{p}{q}
\tag{4.6}
\end{equation}\]</span></p>
</div>
<div id="distribución-binomial-en-r" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Distribución binomial en R</h3>
<p>Para utilizar la distribución binomial en R es bastante sencillo.
Veamos el siguiente ejemplo.</p>
<blockquote>
<p><strong>Ejemplo:</strong> Supongamos que analizamos a 5 individuos de una población en la que el 37% de las personas presentan un alelo mutante.
Las probabilidades de las distintas configuraciones están dadas por la distribución binomial, en donde <span class="math inline">\(n\)</span> = 5 y <span class="math inline">\(p\)</span> = 0.37.
¿Cuál es la probabilidad de que exactamente 2 personas sean mutantes?</p>
</blockquote>
<p>Antes de continuar, hay que saber que existen 4 distintos comandos de la función binomial:</p>
<p>-<code>dbinom()</code> nos da un valor exacto de la distribución binomial en el punto indicado.</p>
<p>-<code>pbinom()</code> nos da la probabilidad acumulada de un evento.</p>
<p>-<code>qbinom()</code> toma el valor de probabilidad que le ponemos como primer argumento y nos da como regreso un número cuya probabilidad acumulada empate con el valor de la probabilidad.</p>
<p>-<code>rbinom()</code> genera cierta cantidad de número aleatorios de acuerdo con la probabilidad y el número de pruebas realizadas.</p>
<p>En este caso, queremos conocer la probabilidad exacta de que 2 personas sean mutantes.
Para esto necesitamos la función <code>dbinom(x, size, prob)</code>, donde el argumento <code>x</code> equivale al número de éxitos, <code>size</code> al número de ensayos y <code>prob</code> a la probabilidad de éxito.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="probabilidad.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="fl">0.37</span>)</span></code></pre></div>
<pre><code>## [1] 0.3423143</code></pre>
<blockquote>
<p><strong>Ejemplo</strong>: En Estados Unidos, 85% de la población tiene sangre Rh positivo.
Supongamos que tomamos 6 personas y contamos cuántos tiene Rh positivo.
En este caso <span class="math inline">\(Y\)</span> representará cuántas personas tienen Rh positivo dentro del grupo de 6.
¿Cuál es la probabilidad de <span class="math inline">\(Y\)</span> = 4?
¿Y la probabilidad de que <em>al menos</em> 4 personas sean Rh positivo?
¿Y la probabilidad de que haya <em>al menos</em> 1 persona con Rh negativo?</p>
</blockquote>
<p>En este caso debemos utilizar dos comandos, <code>dbinom()</code> y <code>pbinom()</code>, con uno calcularemos <span class="math inline">\(\tt Y = 4\)</span> y con el otro <span class="math inline">\(\tt Y \ge 4\)</span> (4 o más).
Como queremos obtener <span class="math inline">\(\tt P(Y \ge 4)\)</span>, entonces <span class="math inline">\(\tt P(Y \ge 4) = P(Y = 4) + P(Y=5) + P(Y=6)\)</span>, utilizamos el argumento <code>lower.tail</code> y lo ponemos en <code>FALSE</code> para indicar que vamos a trabajar con un valor mínimo de 4, para arriba.
Para el caso de <em>al menos</em> una persona con Rh negativo <span class="math inline">\(\tt P(Y &lt; 6)\)</span>, tenemos dos opciones.
Usar <code>dbinom()</code> cinco veces para calcular el valor individual de <span class="math inline">\(\tt P(Y = 0) + P(Y = 1) + P(Y = 2) \cdots + P(Y = 5)\)</span>, o calcular <span class="math inline">\(\tt P(Y = 6)\)</span> y restarle a 1 este valor.
Como vemos ambas operaciones dan los mismos resultados, pero es más sencilla la segunda.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="probabilidad.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="fl">0.85</span>)</span></code></pre></div>
<pre><code>## [1] 0.1761771</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="probabilidad.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="fl">0.85</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.9526614</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="probabilidad.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">0.85</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="fl">0.85</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">0.85</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="fl">0.85</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="fl">0.85</span>) <span class="sc">+</span> <span class="fu">dbinom</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="fl">0.85</span>)</span></code></pre></div>
<pre><code>## [1] 0.6228505</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="probabilidad.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.85</span>)</span></code></pre></div>
<pre><code>## [1] 0.6228505</code></pre>
</div>
</div>
<div id="distribución-normal" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Distribución normal</h2>
<p>Una <strong>distribución normal</strong> corresponde a una curva <em>en forma de campana</em>, con ciertas características específicas.
Se utiliza para representar la distribución de los valores de una variable <span class="math inline">\(\tt X\)</span>, de dos maneras distintas: (1) como una aproximación a un histograma basado en los valores muestreados de la variable <span class="math inline">\(\tt X\)</span> o; (2) como una representación idealizada de la distribución poblacional de <span class="math inline">\(\tt X\)</span>.</p>
<p>Las curvas con distribución normal toman su forma por dos elementos muy importantes: la <strong>media</strong> <span class="math inline">\(\mu\)</span> y su <strong>desviación estándar</strong> <span class="math inline">\(\sigma\)</span>.
Cuando se tiene una curva con distribución normal, se expresa de la siguiente manera <span class="math inline">\(\tt X \sim N(\mu, \sigma)\)</span>.
La fórmula de la distribución normal se encuentra en la ecuación <a href="probabilidad.html#eq:norm">(4.7)</a>.
No se trata de cualquier curva simétrica, si no de una curva simétrica <em>específica</em>.</p>
<p><span class="math display" id="eq:norm">\[\begin{equation}
f(x) = \frac{1}{{\sigma}{\sqrt{2 \pi}}}e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2}
\tag{4.7}
\end{equation}\]</span></p>
<p>La función <span class="math inline">\(\tt f(x)\)</span> se conoce como <strong>función de densidad</strong> y expresa la altura de la curva como una función de la posición en el eje horizontal.
El centro de una curva normal es <span class="math inline">\(\tt x = \mu\)</span>, los puntos de inflexión están en <span class="math inline">\(\tt x = \mu + \sigma\)</span> y <span class="math inline">\(\tt x = \mu - \sigma\)</span>.
En principio la curva se extiende hasta el infinito, pero tres desviaciones estándar de la media hacia el valor negativo o positivo da como resultados valores demasiado pequeños.
El ancho y alto de una curva normal está determinado por la desviación estándar <span class="math inline">\(\sigma\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-75"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-75-1.png" alt="Forma de la distribución normal." width="672" />
<p class="caption">
Figura 4.2: Forma de la distribución normal.
</p>
</div>
<p>Normalmente lo que nos interesa de una curva con distribución normal es el <strong>área debajo de la curva</strong>.
Para esto utilizamos la <strong>escala estandarizada</strong>, en el cual el valor del eje horizontal se denomina <strong>valor Z</strong>.
La escala de Z mide las desviaciones estándar a partir de la media, por ejemplo, <span class="math inline">\(z = 1\)</span> corresponde a una desviación estándar de la media.
Para transformar nuestros datos a la escala Z simplemente aplicamos la ecuación <a href="probabilidad.html#eq:Z">(4.8)</a> y a la variable Z se le conoce como una variable de <strong>distribución normal estándar</strong>, ya que se encuentra estandarizada y no importa en que valor se encuentren los datos originales (kg, °C, cm, mmHg, etc.), la variable Z es <em>adimensional</em>.</p>
<p><span class="math display" id="eq:Z">\[\begin{equation}
Z = \frac{X - \mu}{\sigma}
\tag{4.8}
\end{equation}\]</span></p>
<p>Una vez que nuestras variables se encuentran estandarizadas en el valor Z, podemos utilizar <strong>tablas de Z</strong> para realizar el cálculo debajo del área que corresponde al valor Z obtenido, aunque claro, también podemos hacer estos cálculos en <code>R</code>.
Hay que tener en cuenta que para una curva de distribución normal estándar:</p>
<ul>
<li><p>68% del área se encuentra entre <span class="math inline">\(\tt \pm\)</span> 1 distribución estándar.</p></li>
<li><p>95% del área se encuentra entre <span class="math inline">\(\tt \pm\)</span> 2 distribuciones estándar.</p></li>
<li><p>99.7% del área se encuentra entre <span class="math inline">\(\tt \pm\)</span> 3 distribuciones estándar.</p></li>
</ul>
<div id="distribución-normal-en-r" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Distribución normal en R</h3>
<p>De manera similar a la distribución binomial, en <code>R</code> encontramos comandos similares para la distribución normal, donde tenemos:</p>
<p>-<code>dnorm()</code> nos da un valor de densidad normal en determinado punto (valor puntual de la función de densidad).</p>
<p>-<code>pnorm()</code> nos da un valor de densidad normal acumulado hasta cierto punto (área debajo de la curva).</p>
<p>-<code>qnorm()</code> toma el valor de densidad normal que le ponemos como primer argumento y nos da como regreso un número cuya densidad normal acumulada empate con el valor de densidad normal ingresado.</p>
<p>-<code>rnorm()</code> genera cierta cantidad de número aleatorios de acuerdo al valor de densidad normal.</p>
<p>Intentemos resolver algunos ejercicios.</p>
<blockquote>
<p><strong>Ejemplo:</strong> En una población de peces de la especie <em>Pomolobus aestivalis</em>, la longitud de los individuos sigue una distribución normal. La media de la longitud es de 54.0 mm, y la desviación estándar es de 4.5 mm<sup>2</sup>. ¿Qué porcentaje de los peces mide menos de 60 mm? ¿Qué porcentaje de los peces mide más de 51 mm? ¿Qué porcentaje de los peces miden entre 51 mm y 60 mm?</p>
</blockquote>
<p>Para responder la primer pregunta, debemos transformar nuestros datos a valores Z, ya que se encuentran en mm. Para esto aplicamos la ecuación <a href="probabilidad.html#eq:Z">(4.8)</a>. En <code>R</code> es una operación relativamente sencilla de hacer.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="probabilidad.html#cb114-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">60</span> <span class="sc">-</span> <span class="dv">54</span>)<span class="sc">/</span>(<span class="fl">4.5</span>)</span></code></pre></div>
<pre><code>## [1] 1.333333</code></pre>
<p>Como podemos ver, el valor Z de 60 mm es igual a 1.33. Lo siguiente sería encontrar <em>el área bajo la curva</em> que corresponda a este valor Z. Para esto utilizamos la función <code>pnorm()</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="probabilidad.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.33</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.9082409</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-78"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-78-1.png" alt="Curva de distribución normal con el área sombreada correspondiente a un valor Z = 1.33" width="672" />
<p class="caption">
Figura 4.3: Curva de distribución normal con el área sombreada correspondiente a un valor Z = 1.33
</p>
</div>
<p>De nuevo, el argumento <code>lower.tail = TRUE</code> significa que encontrará la probabilidad acumulada de valores Z menores a 1.33 hasta 1.33. Como podemos ver la probabilidad de que un pez mida menos de 60 mm es de 90.82%.</p>
<p>Para la segunda pregunta, primero debemos encontrar el valor de Z correspondiente a 51 mm y después basta con cambiar el argumento <code>lower.tail</code> a <code>FALSE</code>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="probabilidad.html#cb118-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">51</span> <span class="sc">-</span> <span class="dv">54</span>)<span class="sc">/</span>(<span class="fl">4.5</span>)</span></code></pre></div>
<pre><code>## [1] -0.6666667</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="probabilidad.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.67</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.7485711</code></pre>
<p>Como podemos ver el resultado indica que 75.86% de los peces miden más de 51 mm. Bastante sencillo, ¿no?</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-80"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-80-1.png" alt="Curva de distribución normal con el área sombreada correspondiente a un valor Z = -0.67, pero partiendo desde el lado positivo de la curva." width="672" />
<p class="caption">
Figura 4.4: Curva de distribución normal con el área sombreada correspondiente a un valor Z = -0.67, pero partiendo desde el lado positivo de la curva.
</p>
</div>
<p>Ahora para la última pregunta, simplemente calculamos la probabilidad acumulada hasta nuestro valor Z más grande, que en este caso corresponde a 1.33 y le restamos la probabilidad acumulada del valor Z más pequeño, que corresponde -0.67.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="probabilidad.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.33</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.67</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.656812</code></pre>
<p>Como resultado obtenemos que el 65.68% de los peces se encuentran en longitudes de entre 51 mm y 60 mm. Si nos damos cuenta, la distribución normal puede, de cierta manera, interpretarse como una distribución de probabilidad continua.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-82"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-82-1.png" alt="Curva de distribución normal con el área sombreada correspondiente a un intervalo entre Z = -0.67 y Z = 1.33." width="672" />
<p class="caption">
Figura 4.5: Curva de distribución normal con el área sombreada correspondiente a un intervalo entre Z = -0.67 y Z = 1.33.
</p>
</div>
<p>En algunas ocasiones, queremos encontrar el valor Z correspondiente a un área bajo la curva determinada, para este tipo de ocasiones, utilizamos la función <code>qnorm()</code>.</p>
<p>Del ejemplo anterior, supongamos que queremos encontrar el percentil 70 de la distribución de la longitud de los peces. Supongamos que este valor está representado por la variable <span class="math inline">\(\tt y\)</span>. En otras palabras, queremos encontrar el valor tal que el 70% de las longitudes de los peces son menores que <span class="math inline">\(y\)</span> y el 30% son mayores.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="probabilidad.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.7</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.5244005</code></pre>
<p>Como podemos ver, el valor Z correspondiente es 0.5244. Ahora, utilizando la ecuación <a href="probabilidad.html#eq:Z">(4.8)</a> podemos realizar un despeje muy sencillo y obtener la fórmula <span class="math inline">\(\tt y = Z* \sigma + \mu = 0.5244 * 4.5 + 54 = 56.3\)</span>. Esto quiere decir que 56.3 mm es el percentil 70 de la distribución de nuestros datos.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-84"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-84-1.png" alt="Curva de distribución normal con el área sombreada correspondiente a un valor Z = -0.67, pero partiendo desde el lado positivo de la curva." width="672" />
<p class="caption">
Figura 4.6: Curva de distribución normal con el área sombreada correspondiente a un valor Z = -0.67, pero partiendo desde el lado positivo de la curva.
</p>
</div>
</div>
<div id="pruebas-de-normalidad-en-r" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Pruebas de normalidad en R</h3>
<p>Ya que muchos procedimientos estadísticos se basan en datos provenientes de una población con distribución normal, es importante saber si nuestros datos siguen está distribución.</p>
<p>Uno de los métodos más utilizados son los <strong>gráficos cuantil-cuantil</strong>, <strong>gráficos Q-Q</strong> o <strong>Q-Q plot</strong>. Veamos un ejemplo con datos de plantas que vienen incluidas en <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="probabilidad.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;PlantGrowth&quot;</span>)</span>
<span id="cb126-2"><a href="probabilidad.html#cb126-2" aria-hidden="true" tabindex="-1"></a>PlantGrowth</span></code></pre></div>
<pre><code>##    weight group
## 1    4.17  ctrl
## 2    5.58  ctrl
## 3    5.18  ctrl
## 4    6.11  ctrl
## 5    4.50  ctrl
## 6    4.61  ctrl
## 7    5.17  ctrl
## 8    4.53  ctrl
## 9    5.33  ctrl
## 10   5.14  ctrl
## 11   4.81  trt1
## 12   4.17  trt1
## 13   4.41  trt1
## 14   3.59  trt1
## 15   5.87  trt1
## 16   3.83  trt1
## 17   6.03  trt1
## 18   4.89  trt1
## 19   4.32  trt1
## 20   4.69  trt1
## 21   6.31  trt2
## 22   5.12  trt2
## 23   5.54  trt2
## 24   5.50  trt2
## 25   5.37  trt2
## 26   5.29  trt2
## 27   4.92  trt2
## 28   6.15  trt2
## 29   5.80  trt2
## 30   5.26  trt2</code></pre>
<p>Como podemos ver, tenemos tres grupos, el control, tratamiento 1 y tratamiento 2. Vamos a enfocarnos solamente en los datos del grupo del tratamiento 1.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="probabilidad.html#cb128-1" aria-hidden="true" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> PlantGrowth <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;trt1&quot;</span>), weight)</span>
<span id="cb128-2"><a href="probabilidad.html#cb128-2" aria-hidden="true" tabindex="-1"></a>Datos</span></code></pre></div>
<pre><code>##    weight
## 1    4.17
## 2    5.58
## 3    5.18
## 4    6.11
## 5    4.50
## 6    4.61
## 7    5.17
## 8    4.53
## 9    5.33
## 10   5.14
## 11   4.81
## 12   4.17
## 13   4.41
## 14   3.59
## 15   5.87
## 16   3.83
## 17   6.03
## 18   4.89
## 19   4.32
## 20   4.69
## 21   6.31
## 22   5.12
## 23   5.54
## 24   5.50
## 25   5.37
## 26   5.29
## 27   4.92
## 28   6.15
## 29   5.80
## 30   5.26</code></pre>
<p>Recordemos que podemos utilizar la librería <code>dplyr</code> para extraer ciertos datos de nuestras matrices de datos. Lo que haremos ahora es utilizar el gráfico Q-Q para comprar los datos de nuestra muestra con unos datos teóricos que siguen una distribución normal. En caso de que nuestros datos se comporten de manera normal, deberíamos de tener casi una línea recta. Para esto necesitaremos la librería <code>ggpubr</code>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="probabilidad.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb130-2"><a href="probabilidad.html#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="probabilidad.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(Datos<span class="sc">$</span>weight) <span class="sc">+</span></span>
<span id="cb130-4"><a href="probabilidad.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Teórico&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-5"><a href="probabilidad.html#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Muestra&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-87"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-87-1.png" alt="Gráfico Q-Q comparando una muestra de datos contra una muestra teórica con distribución normal." width="672" />
<p class="caption">
Figura 4.7: Gráfico Q-Q comparando una muestra de datos contra una muestra teórica con distribución normal.
</p>
</div>
<p>Otra opción sería realizar el gráfico de densidad, pero muchas veces es difícil identificar la forma de campana en cierto conjunto de datos, así que los gráficos Q-Q son de gran ayuda.</p>
<p>Otra opción para realizar una prueba de normalidad conocida como <strong>prueba de Shapiro-Wilks</strong> (aunque no se recomienda que para <span class="math inline">\(n &gt; 50\)</span>), pero es muy sensible a ligeras desviaciones de la normalidad, sobre todo con un tamaño de muestra grande. Es muy sencillo de realizar en <code>R</code>, simplemente utilizamos el comando <code>shapiro_test()</code> del paquete <code>rstatix</code>. En este caso, vamos a analizar si nuestros dos tratamientos y el control siguen una distribución normal. Para esto, vamos a hacer uso de la librería <code>dplyr</code>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="probabilidad.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;rstatix&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="probabilidad.html#cb134-1" aria-hidden="true" tabindex="-1"></a>PlantGrowth <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(weight) <span class="co">#Agrupamos los datos por tipo de tratamiento y hacemos la prueba a la variable &quot;weight&quot;.</span></span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   group variable statistic     p
##   &lt;fct&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
## 1 ctrl  weight       0.957 0.747
## 2 trt1  weight       0.930 0.452
## 3 trt2  weight       0.941 0.564</code></pre>
<p>¿Cómo interpretamos los resultados y qué significa el valor-<em>p</em>? Bueno, ya que el control y los dos tratamientos tienen un valor-<em>p</em> &gt; 0.05 decimos que se distribuyen de manera normal. Valores-<em>p</em> menores a 0.05 son indicativos fuertes de no-normalidad. Después de obtener un valor menor a 0.05, podríamos corroborar esto con un gráfico Q-Q o con un histograma para ver la forma de la distribución de nuestros datos.</p>
</div>
</div>
<div id="distribución-muestral" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Distribución muestral</h2>
<p>La variabilidad entre muestras aleatorias que provienen de una misma población se conoce como <strong>variabilidad de muestreo</strong>. Una distribución de probabilidad que caracteriza algún aspecto de la variabilidad de muestreo se conoce como <strong>distribución muestral</strong>. Usualmente los valores de una muestra se parecen a los de la población de la cuál provienen. Una distribución muestral nos indica qué tan cerca la resemblanza entre entre la muestra y la población es probable que sea.</p>
<p>Normalmente tomamos solamente una muestra aleatoria de una población. Pero para visualizar la distribución muestral, necesitamos realizar un <strong>meta-estudio</strong>, que consiste en repetir de manera indefinida, réplicas del mismo estudio. Por ejemplo, si un estudio consiste en extraer una muestra aleatoria de tamaño <span class="math inline">\(\tt n\)</span> de una población, un meta-estudio consiste en repetir varias veces la extracción de una muestra de tamaño <span class="math inline">\(\tt n\)</span> de una población. Por lo tanto, las probabilidades relativas de una muestra aleatoria se pueden interpretar como frecuencias relativas en un meta-estudio. Conocer la distribución muestral nos permite hacer afirmaciones de probabilidad de otras posibles muestras.</p>
<p>Una pregunta natural a realizar es, ¿Qué tan parecida es la media de la muestra <span class="math inline">\(\tt \overline{x}\)</span> de la media de la población <span class="math inline">\(\tt \mu\)</span>? Aunque con una sola muestra no podemos responder esta pregunta, si pensamos en un modelo de muestreo aleatorio y tomamos la media muestral como una variable <span class="math inline">\(\tt \overline{X}\)</span>, podemos hacer ciertas inferencias. Reformulamos nuestra pregunta a ¿Qué tan cerca de <span class="math inline">\(\tt \mu\)</span> es probable que este <span class="math inline">\(\tt \overline{X}\)</span>? Nuestra respuesta la encontramos en la <strong>distribución muestral de <span class="math inline">\(\tt \overline{X}\)</span></strong>.</p>
<p>Tenemos que tener en cuenta que, en promedio, la <strong>media de la distribución muestral</strong> <span class="math inline">\(\tt \overline{X}\)</span> equivale a la media de la población <span class="math inline">\(\tt \mu\)</span>. Esto se ve mejor en la fórmula <a href="probabilidad.html#eq:samplemean">(4.9)</a>.</p>
<p><span class="math display" id="eq:samplemean">\[\begin{equation}
\mu_{\overline{X}} = \mu
\tag{4.9}
\end{equation}\]</span></p>
<p>La fórmula de la <strong>desviación estándar de la muestra</strong> es un poco menos intuitiva, aunque si se analiza de manera detallada tiene sentido.</p>
<p><span class="math display" id="eq:samplesd">\[\begin{equation}
\sigma_{\overline{X}} = \frac{\sigma}{\sqrt{n}}
\tag{4.10}
\end{equation}\]</span></p>
<p>Mientras el tamaño de muestra incrementa, la desviación estándar de <span class="math inline">\(\tt \overline{X}\)</span> disminuye. Es decir para muestras más grandes existe menos variación.</p>
<p>La <strong>forma</strong> está determinada por el tamaño de muestra y la naturaleza de la población. Si la población <span class="math inline">\(\tt X\)</span> se distribuye de manera normal, entonces la distribución muestral de <span class="math inline">\(\tt \overline{X}\)</span> será también normal, sin importar el tamaño de nuestra <span class="math inline">\(\tt n\)</span>. Además el <strong>teorema del límite central</strong> indica que si obtenemos una <span class="math inline">\(\tt n\)</span> suficientemente grande, la distribución muestral de <span class="math inline">\(\tt \overline{X}\)</span> será aproximadamente normal incluso para muestras cuya población <span class="math inline">\(\tt X\)</span> no se distribuye de manera normal.</p>
<blockquote>
<p><strong>Ejemplo:</strong> Supongamos que tenemos una población del Carbonerito Mexicano (<em>Poecile sclateri</em>) en la cuál el peso medio es de <span class="math inline">\(\tt \mu = 11 g\)</span> y la desviación estándar <span class="math inline">\(\tt \sigma = 1.2 g\)</span>. Supongamos que tomamos una muestra aleatoria de seis aves. Dejemos que <span class="math inline">\(\tt \overline{x}\)</span> represente la media del peso de las seis aves. Ya que sabemos que el peso de esta ave sigue una distribución normal en la población, también nuestras muestras seguirán una distribución normal.</p>
</blockquote>
<p>Para este caso, la media y la desviación estándar de nuestra muestra serán las siguientes:</p>
<p><span class="math display">\[\begin{equation}
\mu_{\overline{X}} = \mu = 11 g\\
\sigma_{\overline{X}} = \frac{\sigma}{\sqrt{n}} = \frac{1.2}{\sqrt{6}} = 0.49 g
\end{equation}\]</span></p>
<p>En este caso <span class="math inline">\(\tt \mu_{\overline{X}} = 11 g\)</span> y <span class="math inline">\(\tt \sigma_{\overline{X}} = 0.49 g\)</span>. De tal manera que, en promedio la media de la muestra será 11 g, sin embargo, el 68% de las veces <span class="math inline">\(\tt \overline{X}\)</span> se encontrará entre <span class="math inline">\(\tt 11g \pm 0.49g\)</span> y el 95% de las veces se encontrará entre <span class="math inline">\(\tt 11g \pm 0.98g\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-89"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-89-1.png" alt="Distribución muestral proveniente de una población de *Sclateri poecile*." width="672" />
<p class="caption">
Figura 4.8: Distribución muestral proveniente de una población de <em>Sclateri poecile</em>.
</p>
</div>
<p>Esta distribución muestral expresa distintas posibilidades para los valores de <span class="math inline">\(\tt \overline{X}\)</span>. Supongamos que quisiéramos saber la probabilidad de que la media de una muestra de seis aves sea mayor a 11.5 g. Ya que nuestros datos son normales, podemos usar la transformación a valores Z para obtener nuestro resultado.</p>
<p><span class="math display">\[\begin{equation}
Z = \frac{\overline{x}-\mu_\overline{X}}{\sigma_{\overline{X}}} = \frac{11.5 - 11}{0.49} = 1.0204
\end{equation}\]</span></p>
<p>Ya que nuestro valor Z = 1.0204, usamos la función <code>pnorm()</code> para encontrar nuestra área bajo la curva.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="probabilidad.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.0204</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1537694</code></pre>
<p>De hecho, ni siquiera es necesario realizar la transformación a valores Z en <code>R</code> ya que podemos modificar los parámetros de la función <code>pnorm()</code>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="probabilidad.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">11.5</span>, <span class="at">mean =</span> <span class="dv">11</span>, <span class="at">sd =</span> <span class="fl">0.49</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1537675</code></pre>
<p>Debido a que hemos redondeado la desviación estándar el valor es ligeramente distinto, pero en esencia el resultado es el mismo. Entonces podemos concluir que</p>
<p><span class="math display">\[\begin{equation}
P(\overline{X} &gt; 11.5) = P(Z &gt; 1.0204) = 0.1538 \approx 0.15
\end{equation}\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-92"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-92-1.png" alt="Probabilidad de que la media de una muestra de seis aves de la especie *Poecile sclateri* sea mayor a 11.5." width="672" />
<p class="caption">
Figura 4.9: Probabilidad de que la media de una muestra de seis aves de la especie <em>Poecile sclateri</em> sea mayor a 11.5.
</p>
</div>
<p>Si eligiéramos muchas muestras aleatorias provenientes de esta población cerca del 15% de las muestras tendrían una media mayor a 11.5 g.</p>
<p>El <strong>tamaño de la muestra</strong> tiene un efecto directo sobre la forma de nuestra curva. Básicamente, muestras más grandes dan un <span class="math inline">\(\tt \sigma_\overline{X}\)</span> menor, y por ende dan un menor error de muestreo. En seguida se muestran distintas gráficas con distintas <span class="math inline">\(\tt \mu_\overline{X}\)</span>. Para este caso hipotético, <span class="math inline">\(\tt \mu = 100, \sigma = 40\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-93-1"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-93-1.png" alt="Cambios en la forma de la curva dependientes de la desviación estándar muestral." width="672" />
<p class="caption">
Figura 4.10: Cambios en la forma de la curva dependientes de la desviación estándar muestral.
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-93-2"></span>
<img src="Curso_R_basico_files/figure-html/unnamed-chunk-93-2.png" alt="Cambios en la forma de la curva dependientes de la desviación estándar muestral." width="672" />
<p class="caption">
Figura 4.11: Cambios en la forma de la curva dependientes de la desviación estándar muestral.
</p>
</div>
<p>Qué tan cerca esta <span class="math inline">\(\tt \overline{X}\)</span> de <span class="math inline">\(\tt \mu\)</span> depende del tamaño de la muestra <span class="math inline">\(\tt n\)</span>. La media de una muestra grande no necesariamente está más cerca a la media poblacional que la media de una muestra pequeña, pero existe mayor probabilidad de que lo este.</p>
<div id="poblaciones-muestras-y-distribuciones-muestrales" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Poblaciones, muestras y distribuciones muestrales</h3>
<p>Una vez llegado a este punto puede que exista confusión entre los valores de una población, de una muestra y de una distribución muestral. Para esto aclaremos los siguientes puntos, en torno a una variable <span class="math inline">\(\tt X\)</span>.</p>
<p>En una <strong>población</strong>, los estadísticos descriptivos como la media y la desviación estándar se representan por los siguientes símbolos:</p>
<ul>
<li><p><span class="math inline">\(\tt \mu\)</span>: media poblacional.</p></li>
<li><p><span class="math inline">\(\tt \sigma\)</span>: desviación estándar poblacional.</p></li>
</ul>
<p>En una <strong>muestra</strong>, los mismos estadísticos se representan por los siguientes símbolos:</p>
<ul>
<li><p><span class="math inline">\(\tt \overline{x}\)</span>: media muestral.</p></li>
<li><p><span class="math inline">\(\tt s\)</span>: desviación estándar poblacional.</p></li>
</ul>
<p>En una <strong>distribución muestral</strong> lo que nosotros hacemos es repetir un muestreo indefinidas veces (meta-estudio) y de cada muestreo extraer la media muestral <span class="math inline">\(\tt \overline{x}\)</span>. Lo que representa la distribución muestral es una distribución de medias, en lugar de observaciones individuales.</p>
<ul>
<li><p><span class="math inline">\(\tt \mu_\overline{X}\)</span>: media de una distribución muestral.</p></li>
<li><p><span class="math inline">\(\tt \sigma_\overline{X}\)</span>: desviación estándar de una distribución muestral.</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estadística-descriptiva.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
