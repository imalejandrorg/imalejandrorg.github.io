[["histogramas-y-gráficos-de-densidad.html", "Lección 3 Histogramas y gráficos de densidad 3.1 R y ggplot2", " Lección 3 Histogramas y gráficos de densidad Un histograma es una representación de la distribución de datos de una variable numérica. Un histograma nos puede mostrar la forma de la distribución de los datos de nuestra variable. Las áreas dentro de un histograma corresponden a las frecuencias de dichas clases. De igual manera, la forma de un histograma puede ser muy útil al momento de interpretar datos. Se dice que un histograma es unimodal cuando solamente se aprecia un pico máximo en los datos y bimodal cuando se observan dos. Además un histograma puede estar sesgado cuando los datos se cargan hacia uno de los extremos. Se dice que un histograma está sesgado hacia la izquierda cuando la el modo (pico) esta cargado a la derecha, dejando una cola larga hacia la izquierda y que está sesgado hacia la derecha cuando ocurre lo contrario. Podemos ver en la figura 3.1 los distintos tipos de distribuciones que se pueden formar si trazamos una línea sobre los histogramas, tomado de Samuels et al. (2016). Figura 3.1: Formas de distribución. Una curva de densidad es una forma de representar la distribución de frecuencias de variables continuas, generalmente con una línea curva. El eje de las abscisas generalmente está representado por una escala llamada escala de densidad. Cuando esto es así, las frecuencias relativas están representadas como el área debajo de la curva. El área total debajo de la curva debe ser igual a 1. 3.1 R y ggplot2 En esta sección aprenderemos a utilizar las herramientas incluidas en R para la elaboración de histogramas y gráficos de densidad. Sin embargo, también utilizaremos una librería que nos permitirá visualizar mejor los datos llamada gplot2. 3.1.1 Histogramas y gráficos de densidad en R En esta ocasión utilizaremos la base de datos mtcars que viene incluida en el paquete ggplot2. library(ggplot2) data(mtcars) Para crear un histograma con las herramientas básicas de R simplemente escribimos el siguiente código. El argumento prob = TRUE hace que la abscisa (y) este representado por una escala de densidad en lugar de los valores de las variables. hist(mtcars$mpg, prob = TRUE) Figura 3.2: Histograma de la matriz de datos mtcars. El eje de la x representa las millas por galón y el eje y repesenta la escala de densidad. En caso de que queramos hacer un gráfico de densidad en lugar de un histograma podemos utilizar el siguiente código. La función density() nos muestra la información acerca de la distribución de los datos. Para ver el gráfico debemos utilizar la función plot(). plot(density(mtcars$mpg)) Figura 3.3: Gráfico de densidad de la matriz de datos mtcars. El eje de la x representa las millas por galón y el eje y repesenta la escala de densidad. Podemos visualizar tanto el histograma como la línea de densidad en el mismo gráfico. Para esto graficamos el histograma de manera normal con la función hist() pero después de esto utilizamos la función lines(). hist(mtcars$mpg, prob = TRUE) lines(density(mtcars$mpg), col = &quot;blue&quot;) Figura 3.4: Histograma y gráfico de densidad de la matriz de datos mtcars. 3.1.2 Histogramas y gráficos de densidad en ggplot2 Como ya hemos cargado ggplot2 en el ejemplo anterior para poder importar la base de datos, no es necesario volver a cargarlo. Empecemos entonces con el gráfico más básico de nuestros datos utilizando las funciones ggplot() y geom_density(). ggplot(mtcars, aes(x = mpg)) + geom_density() Figura 3.5: Gráfico de densidad utilizando ggplot2. Podemos agregar etiquetas a los valores de x y y. ggplot(mtcars, aes(x = mpg)) + geom_density() + labs(x = &quot;Milas por galón&quot;, y = &quot;Densidad&quot;) Figura 3.6: Gráfico de densidad utilizando ggplot2 con las etiquetas modificadas. Además podemos rellenar el área debajo de la curva con el argumento fill. ggplot(mtcars, aes(x = mpg)) + geom_density(fill = &quot;lightblue&quot;) + labs(x = &quot;Milas por galón&quot;, y = &quot;Densidad&quot;) Figura 3.7: Gráfico de densidad utilizando ggplot2 con el área bajo la curva rellena. Adicionalmente podemos modificar la transparencia con el argumento alpha. ggplot(mtcars, aes(x = mpg)) + geom_density(fill = &quot;lightblue&quot;, alpha = 0.5) + labs(x = &quot;Milas por galón&quot;, y = &quot;Densidad&quot;) Figura 3.8: Gráfico de densidad utilizando ggplot2 relleno y con transparencia modificada. De igual manera, podemos indicar la posición de la media en este gráfico. Primero debemos de caluclar la media con la función mean(). mpg.mean &lt;- mean(mtcars$mpg) Una vez calculada la media, podemos utilizar otra función llamada geom_vline en el gráfico que ya habíamos creado. ggplot(mtcars, aes(x = mpg)) + geom_density(fill = &quot;lightblue&quot;, alpha = 0.5) + labs(x = &quot;Milas por galón&quot;, y = &quot;Densidad&quot;) + geom_vline(xintercept = mpg.mean, size = 1, color = &quot;red&quot;, linetype = &quot;solid&quot;) Figura 3.9: Gráfico de densidad utilizando ggplot2 en donde se indica la media. Adicionalmente podemos explorar distintos temas que ggplot2 ofrece. ggplot(mtcars, aes(x = mpg)) + geom_density(fill = &quot;lightblue&quot;, alpha = 0.5) + labs(x = &quot;Milas por galón&quot;, y = &quot;Densidad&quot;) + geom_vline(xintercept = mpg.mean, size = 1, color = &quot;red&quot;, linetype = &quot;solid&quot;) + theme_classic() Figura 3.10: Gráfico de densidad utilizando ggplot2 modificando los temas.. "]]
